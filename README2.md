# Прогнозирование Оттока Клиентов для Телекоммуникационной компании

## Описание проекта

Проект направлен на создание модели машинного обучения для прогнозирования вероятности оттока клиентов телекоммуникационной компании на основе исторических данных. Цель — помочь компании выявить клиентов, склонных к оттоку, и минимизировать потери.

## Анализ данных

Мы сделали анализ данных. Данные о клиентах телекоммуникационной компании были загружены, проверены на наличие пропусков, дубликатов и отрицательных значений. Основные статистические характеристики рассчитаны, данные визуализированы для выявления закономерностей и анализа распределений. Эти шаги помогли подготовить данные для дальнейшего моделирования и улучшить понимание ключевых факторов, влияющих на отток клиентов.
![Анализ данных](./img-readme/data-analysis.jpg)

## Описание данных

Набор данных состоит из 72,274 записей и 11 столбцов, содержащих информацию о клиентах телекоммуникационной компании. Структура данных следующая:

- **id**: уникальный идентификатор клиента.
- **is_tv_subscriber**: индикатор подписки на телевидение (1 - да, 0 - нет).
- **is_movie_package_subscriber**: индикатор подписки на пакет фильмов (1 - да, 0 - нет).
- **subscription_age**: возраст подписки в годах.
- **bill_avg**: средний счет клиента.
- **remaining_contract**: оставшийся срок контракта (значение пропущено для 21,572 клиентов).
- **service_failure_count**: количество сбоев в обслуживании.
- **download_avg**: средняя скорость загрузки.
- **upload_avg**: средняя скорость выгрузки (значение пропущено для 381 клиента).
- **download_over_limit**: индикатор превышения лимита загрузки (1 - да, 0 - нет).
- **churn**: индикатор оттока клиентов (1 - ушел, 0 - остался).

### Статистические характеристики

- Средний возраст подписки: 2.45 года
- Средний счет клиента: 18.94
- Процент клиентов с подпиской на телевидение: 81.53%
- Процент клиентов с подпиской на пакет фильмов: 33.46%
- Процент ушедших клиентов: 55.41%

### Пропуски и аномалии

- В столбце **remaining_contract** 21,572 записи имеют пропуски.
- В столбце **subscription_age** 1 значение отрицательное, что требует дополнительной проверки.

### Дубликаты и негативные значения

- Дубликатов в данных не обнаружено.
- Отрицательных значений в большинстве столбцов нет, кроме одного случая в **subscription_age**.

## Подготовка и очиститка данных

Мы подготовили и очистили данные, создав несколько наборов для сравнения.

- **data_no_na**: Удалены все строки с пропусками.
- **data_mode**: Пропуски в столбцах заполнены модой.
- **data_mean**: Пропуски заполнены средними значениями.

Мы подготовили и очистили данные, создав несколько наборов для сравнения.

Удаление пропусков уменьшило размер данных на 30%, что может повлиять на результаты, так как распределение целевой переменной churn стало искажённым. Заполнение пропусков модой и средними значениями позволило сохранить первоначальный объем данных и не изменило среднее значение churn. Корреляции с churn остались более выраженными в датасете с заполнением модой, что помогает сохранить важную информацию.

В итоге, был выбран метод заполнения пропусков модой, так как он сохраняет структуру данных и важные зависимости.

![Подготовка данных](./img-readme/data-preparation.jpg)

## Оценка моделей машинного обучения

Мы оценили несколько моделей машинного обучения. Наилучшие результаты показали XGBoost и Нейронные сети, демонстрируя высокие показатели точности и AUC. Случайный лес и Деревья решений тоже оказались эффективными, но немного уступают по AUC. Логистическая регрессия и SVM показали сбалансированные результаты, а k-NN и Наивный байесовский классификатор оказались менее успешными.

Предпочтительной моделью для задачи является XGBoost, который показал наилучшие результаты

![Подготовка данных](./img-readme/model-comparison-table.png)

## Инструкции по запуску проекта

### Через Docker

1. **Скачайте файлы проекта**.
   https://github.com/basilegupov/DataScienceProject/tree/main

2. **Запустите Docker Desktop**.

3. **В консоли выполните команды**:

   ```bash
   docker-compose build --no-cache
   docker-compose up

   ```

4. После этого проект будет доступен по адресу: http://localhost:8000/.

5. **Повторный запуск через Запустите Docker Desktop**.

### Через виртуальную среду

1. Скачайте файлы проекта https://github.com/basilegupov/DataScienceProject/tree/main .

2. Запустите виртуальную среду с помощью команды: pipenv shell
   Убедитесь, что вы находитесь в нужной директории.

3. Установите необходимые библиотеки: pipenv install django joblib scikit-learn xgboost

4. Запустите сервер с помощью команды: python manage.py runserver

5. После этого сервер должен запуститься, и вы сможете получить доступ к своему Django-проекту через веб-браузер по адресу: http://127.0.0.1:8000/.

- Docker позволяет изолировать проект в контейнере и автоматизирует настройку зависимостей и окружения.
- Виртуальная среда pipenv используется для локальной настройки окружения без контейнеризации, где все библиотеки устанавливаются в виртуальной среде Python.

Оба варианта запускают один и тот же проект, но Docker предлагает более изолированное и универсальное решение для развёртывания.

![Подготовка данных](./img-readme/app.png)
